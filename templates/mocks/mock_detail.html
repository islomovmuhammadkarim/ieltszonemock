{% extends "layouts/master.html" %}
{% load static %}

{% block title %}{{ mock.title }} — Tafsilotlar{% endblock %}

{% block content %}
<div class="container" style="padding-top: 50px; max-width: 900px;">
    
    <nav style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 40px;">
        <a class="btn-ios-back" href="{% url 'mock_list' %}">
            <i class="fas fa-arrow-left"></i> <span>Katalogga qaytish</span>
        </a>
        <div class="ios-status-pill">
            {% if has_access %}
                <span class="dot-green"></span> To'liq kirish mavjud
            {% else %}
                <span class="dot-red"></span> Kirish cheklangan
            {% endif %}
        </div>
    </nav>

    <header style="margin-bottom: 40px;">
        <h1 style="font-size: clamp(28px, 5vw, 42px); font-weight: 900; letter-spacing: -2px; margin-bottom: 15px;">
            {{ mock.title }}
        </h1>
        <div class="card-glass" style="padding: 20px; border-radius: 20px;">
            <p class="muted" style="font-size: 16px; line-height: 1.6; margin: 0;">
                {{ mock.description|default:"Ushbu imtihon IELTS standartlari asosida tuzilgan bo'lib, barcha 4 ta asosiy ko'nikmani (Listening, Reading, Writing, Speaking) kompleks tekshirish imkonini beradi." }}
            </p>
        </div>
    </header>

    <section class="stats-row" style="margin-bottom: 50px;">
        <div class="stat-card">
            <span class="stat-label">VAQT</span>
            <span class="stat-value"><i class="far fa-clock"></i> {{ mock.estimated_minutes }} m</span>
        </div>
        <div class="stat-card">
            <span class="stat-label">NARX</span>
            <span class="stat-value">
                {% if mock.is_free %}Tekin{% else %}{{ mock.price_uzs|floatformat:0 }} s{% endif %}
            </span>
        </div>
        <div class="stat-card">
            <span class="stat-label">SAVOLLAR</span>
            <span class="stat-value"><i class="fas fa-list-ol"></i> 80+</span>
        </div>
    </section>

    <h2 style="font-size: 22px; font-weight: 800; letter-spacing: -0.5px; margin-bottom: 25px;">Imtihon <span style="color: var(--brand);">tarkibi</span></h2>
    
    <div class="grid grid-2" style="gap: 20px; margin-bottom: 60px;">
        {% for section in sections %}
            <article class="section-card accent-{{ section.section }}">
                <div class="card-inner">
                    <div class="section-header">
                        <div class="ios-icon-sm {{ section.section }}">
                            {% if section.section == "listening" %}<i class="fas fa-headphones"></i>
                            {% elif section.section == "reading" %}<i class="fas fa-book-open"></i>
                            {% elif section.section == "writing" %}<i class="fas fa-pen-nib"></i>
                            {% elif section.section == "speaking" %}<i class="fas fa-microphone-lines"></i>
                            {% endif %}
                        </div>
                        <div class="section-meta">
                            <h3 style="font-size: 18px; font-weight: 800; margin: 0; color: #fff;">{{ section.get_section_display }}</h3>
                            <span class="text-dim">{{ section.duration_minutes }} min • {{ section.questions_count }} savol</span>
                        </div>
                    </div>

                    <div class="section-action">
                        {% if has_access %}
                            <a class="btn-ios-start" href="{% url 'mock_start' mock.slug %}?section={{ section.id }}">
                                Boshlash <i class="fas fa-chevron-right"></i>
                            </a>
                        {% else %}
                            <a class="btn-ios-lock" href="{% url 'shop' %}">
                                <i class="fas fa-lock"></i> Unlock
                            </a>
                        {% endif %}
                    </div>
                </div>
            </article>
        {% endfor %}
    </div>

    <section class="result-footer card-glass">
        <div style="max-width: 500px; margin: 0 auto; text-align: center;">
            <div class="result-icon-box">
                <i class="fas fa-chart-pie"></i>
            </div>
            <h3 style="font-size: 20px; font-weight: 800; margin-bottom: 10px;">Imtihon natijalari</h3>
            <p class="muted" style="margin-bottom: 30px;">Barcha bo'limlarni yakunlaganingizdan so'ng, tizim avtomatik ravishda umumiy hisobotni shakllantiradi.</p>
            
            <div style="display: flex; gap: 12px; justify-content: center;">
                <button class="btn btn-ghost" style="border-radius: 16px; padding: 14px 24px;">To'liq hisobot</button>
                <button class="btn btn-primary" style="border-radius: 16px; padding: 14px 24px;">Ballarni ko'rish</button>
            </div>
        </div>
    </section>

</div>

<style>
    /* Stats Bar */
    .stats-row {
        display: grid;
        grid-template-columns: repeat(3, 1fr);
        gap: 15px;
    }
    .stat-card {
        background: rgba(255,255,255,0.03);
        border: 1px solid rgba(255,255,255,0.08);
        padding: 20px;
        border-radius: 24px;
        text-align: center;
    }
    .stat-label { display: block; font-size: 10px; font-weight: 900; color: var(--muted); letter-spacing: 1px; margin-bottom: 5px; }
    .stat-value { font-size: 18px; font-weight: 800; color: #fff; }

    /* Section Cards */
    .section-card {
        background: rgba(255,255,255,0.03);
        border: 1px solid rgba(255,255,255,0.08);
        border-radius: 28px;
        transition: 0.4s cubic-bezier(0.16, 1, 0.3, 1);
        position: relative;
        overflow: hidden;
    }
    .section-card:hover {
        transform: translateY(-5px);
        background: rgba(255,255,255,0.06);
        border-color: var(--accent);
    }
    .card-inner { padding: 24px; }
    .section-header { display: flex; align-items: center; gap: 15px; margin-bottom: 25px; }
    .text-dim { font-size: 13px; color: var(--muted); }

    /* Buttons */
    .btn-ios-start {
        display: flex; align-items: center; justify-content: center; gap: 8px;
        background: #fff; color: #000; font-weight: 700; font-size: 14px;
        padding: 14px; border-radius: 16px; text-decoration: none; transition: 0.3s;
    }
    .btn-ios-start:hover { background: var(--accent); color: #fff; }
    
    .btn-ios-lock {
        display: flex; align-items: center; justify-content: center; gap: 8px;
        background: rgba(255,255,255,0.05); color: var(--muted); font-weight: 700;
        padding: 14px; border-radius: 16px; text-decoration: none; border: 1px solid rgba(255,255,255,0.1);
    }

    /* Status Pill */
    .ios-status-pill {
        background: rgba(255,255,255,0.05);
        padding: 8px 16px;
        border-radius: 999px;
        font-size: 13px; font-weight: 600;
        display: flex; align-items: center; gap: 8px;
    }
    .dot-green { width: 8px; height: 8px; background: #4ade80; border-radius: 50%; box-shadow: 0 0 10px #4ade80; }
    .dot-red { width: 8px; height: 8px; background: #f87171; border-radius: 50%; }

    /* Result Footer */
    .result-footer {
        padding: 50px 30px;
        border-radius: 32px;
        border: 1px solid rgba(79, 140, 255, 0.2);
        background: radial-gradient(circle at top right, rgba(79, 140, 255, 0.1), transparent);
    }
    .result-icon-box {
        width: 60px; height: 60px; background: rgba(79, 140, 255, 0.15);
        border-radius: 20px; display: grid; place-items: center;
        font-size: 24px; color: var(--brand); margin: 0 auto 20px;
    }

    /* General Card Glass */
    .card-glass { background: rgba(255,255,255,0.03); border: 1px solid rgba(255,255,255,0.08); backdrop-filter: blur(10px); }
</style>
{% endblock %}