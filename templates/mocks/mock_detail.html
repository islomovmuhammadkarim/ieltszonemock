{% extends "layouts/master.html" %}
{% load static %}

{% block title %}{{ mock.title }} — Tafsilotlar{% endblock %}

{% block content %}
<div class="container container-narrow" style="padding-top: 50px;">

  <!-- Top nav -->
  <nav class="detail-topnav">
    <a class="btn-ios-back" href="{% url 'mock_list' %}">
      <i class="fas fa-arrow-left"></i>
      <span>Katalogga qaytish</span>
    </a>

    <div class="ios-status-pill">
      {% if has_access %}
        <span class="dot-green"></span> To'liq kirish mavjud
      {% else %}
        <span class="dot-red"></span> Kirish cheklangan
      {% endif %}
    </div>
  </nav>

  <!-- Header -->
  <header class="detail-header">
    <h1 class="detail-title">{{ mock.title }}</h1>

    <div class="card-glass">
      <div style="padding: 20px;">
        <p class="detail-desc">
          {{ mock.description|default:"Ushbu imtihon IELTS standartlari asosida tuzilgan bo'lib, barcha 4 ta asosiy ko'nikmani (Listening, Reading, Writing, Speaking) kompleks tekshirish imkonini beradi." }}
        </p>
      </div>
    </div>
  </header>

  <!-- Stats -->
  <section class="stats-row">
    <div class="stat-card">
      <span class="stat-label">VAQT</span>
      <span class="stat-value"><i class="far fa-clock"></i> {{ mock.estimated_minutes }} m</span>
    </div>

    <div class="stat-card">
      <span class="stat-label">NARX</span>
      <span class="stat-value">
        {% if mock.is_free %}Tekin{% else %}{{ mock.price_uzs|floatformat:0 }} s{% endif %}
      </span>
    </div>

    <div class="stat-card">
      <span class="stat-label">SAVOLLAR</span>
      <span class="stat-value"><i class="fas fa-list-ol"></i> 80+</span>
    </div>
  </section>

  <!-- Sections -->
  <h2 class="detail-subtitle">Imtihon <span>tarkibi</span></h2>

  <div class="grid grid-2" style="margin-bottom: 60px;">
    {% for section in sections %}
      <article class="section-card accent-{{ section.section }}">
        <div class="card-inner">

          <div class="section-header">
            <div class="ios-icon-sm">
              {% if section.section == "listening" %}<i class="fas fa-headphones"></i>
              {% elif section.section == "reading" %}<i class="fas fa-book-open"></i>
              {% elif section.section == "writing" %}<i class="fas fa-pen-nib"></i>
              {% elif section.section == "speaking" %}<i class="fas fa-microphone-lines"></i>
              {% endif %}
            </div>

            <div class="section-meta">
              <h3>{{ section.get_section_display }}</h3>
              <span class="text-dim">{{ section.duration_minutes }} min • {{ section.questions_count }} savol</span>
            </div>
          </div>

          <div class="section-action">
            {% if has_access %}
              <a class="btn-ios-start" href="{% url 'mock_start' mock.slug %}?section={{ section.id }}">
                Boshlash <i class="fas fa-chevron-right"></i>
              </a>
            {% else %}
              <a class="btn-ios-lock" href="{% url 'home' %}">
                <i class="fas fa-lock"></i> Unlock
              </a>
            {% endif %}
          </div>

        </div>
      </article>
    {% endfor %}
  </div>

  <!-- Result footer -->
  <section class="result-footer card-glass">
    <div class="result-wrap">

      <div class="result-icon-box">
        <i class="fas fa-chart-pie"></i>
      </div>

      <h3 class="result-title">Imtihon natijalari</h3>
      <p class="result-text">
        Barcha bo'limlarni yakunlaganingizdan so'ng, tizim avtomatik ravishda umumiy hisobotni shakllantiradi.
      </p>

      <div class="actions-row">
        <button class="btn btn-ghost" style="border-radius: 16px; padding: 14px 24px;">To'liq hisobot</button>
        <button class="btn btn-primary" style="border-radius: 16px; padding: 14px 24px;">Ballarni ko'rish</button>
      </div>

    </div>
  </section>

</div>
{% endblock %}
